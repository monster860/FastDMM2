"use strict";function reduce(e,t,i){let n=new Uint8Array(t*i),h=t>>1,r=i>>1,u=t<<2;for(let i=0;i<r;i++)for(let r=0;r<h;r++){let o=(i<<1)*t+(r<<1)<<2,f=e[o+3],s=e[o+7],c=e[o+u+3],d=e[o+u+7],g=f+s+c+d;if(0==g)continue;let l=f*f+s*s+c*c+d*d,a=e[o]*f+e[o+4]*s+e[o+u]*c+e[o+u+4]*d,w=e[o+1]*f+e[o+5]*s+e[o+u+1]*c+e[o+u+5]*d,y=e[o+2]*f+e[o+6]*s+e[o+u+2]*c+e[o+u+6]*d,_=i*h+r<<2;n[_]=a/g|0,n[_+1]=w/g|0,n[_+2]=y/g|0,n[_+3]=l/g|0}return n}onmessage=function(e){let t=e.data,i=t.icon_width,n=t.icon_height,h=t.width,r=t.height,u=new Uint8Array(t.in_buf),o=[];for(;0==(1&i)&&0==(1&n)&&i&&n&&o.length<5;)u=reduce(u,h,r),o.push(u.buffer),h>>>=1,r>>>=1,i>>>=1,n>>>=1;postMessage({key:t.key,out_bufs:o,width:t.width,height:t.height},o)};